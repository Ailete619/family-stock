# 企画・提案書

## 1. プロジェクト概要
- **名称**: FamilyStock（ファミリーストック）
- **カテゴリ**: 家庭向け消費財管理・買い物支援 iOS アプリ
- **開発環境**: SwiftUI / SwiftData / Supabase（BaaS）によるネイティブ iOS
- **目的**: 家庭内の食品・日用品を一元管理し、在庫切れの自動検知と買い物リスト連携、レシート保存までをシームレスに提供する。

## 2. 背景・課題
- 共働き世帯や子育て世代では在庫管理が属人的で、二重購入や買い忘れが発生しやすい。
- スプレッドシートや紙ベースの管理は入力が煩雑で、モバイルからの更新・共有に弱い。
- 既存の買い物アプリは「在庫 → 補充 → 購入記録」の一連のライフサイクルを横断的にサポートしていない。

## 3. 目的
1. 家庭内の消費財を誰でも簡単に可視化できる仕組みを提供。
2. 在庫状況にもとづいて買い物リストを半自動生成し、買い忘れゼロを目指す。
3. 購入履歴（レシート）を蓄積し、支出傾向を後から参照できる基盤を整備。
4. オフライン環境でも更新でき、オンライン復帰時に自動同期される安心感を提供。

## 4. ターゲットユーザー
- 家庭内の食材・日用品管理を担当する 20〜40 代のファミリー層。
- ルームシェア中で共同購入管理を行いたい大学生・社会人。
- 介護や見守りの一環で離れた家族の物品状況を把握したいユーザー。

## 5. 価値提案
| 課題 | FamilyStock の提供価値 |
| --- | --- |
| 在庫状況を把握するのが面倒 | 物品ごとの残量・カテゴリをアプリ内で管理し、写真やラベルがなくても一覧で可視化。 |
| 買い物リストが手作業 | 残量ゼロになった時点で自動的に買い物リストへ追加。 |
| オフラインでの利用 | SwiftData と独自キューによるオフラインファースト設計で接続不良時も操作可。 |
| データが散逸する | Supabase との同期によりマルチデバイスで同じ情報を共有。 |

## 6. 提供機能（ハイレベル）
1. **在庫管理**: 物品名・カテゴリ・在庫/フル在庫量・アーカイブ管理。
2. **買い物リスト自動生成**: 在庫ゼロや手動操作から Shopping List Entry を作成。
3. **レシート登録**: 完了済み買い物エントリからレシートと内訳アイテムを生成。
4. **同期サービス**: Supabase を利用した pull/push、コンフリクト解消、削除伝搬。
5. **オフラインキュー**: `PendingSync` モデルと `OfflineQueueService` による再送制御。
6. **設定・認証**: Supabase 認証、ローカルモード切り替え、最終同期日時の保存。

## 7. 成功指標（KPI）
- **DAU / 継続率**: 30 日後継続率 40%以上。
- **買い忘れ防止**: ユーザーアンケートで「買い忘れが減った」と回答する割合 70%以上。
- **同期成功率**: オフラインキュー経由の最終成功率 99%以上。
- **登録アイテム数**: 1 世帯あたり平均 30 アイテム以上のトラッキング。

## 8. 体制・スケジュール（例）
| フェーズ | 期間 | 主担当 | 成果物 |
| --- | --- | --- | --- |
| 企画・要件 | 2 週間 | PdM / デザイナー / リードエンジニア | 本書、ペルソナ、要件定義書 |
| 設計 | 3 週間 | リードエンジニア | 基本設計・詳細設計書、デザインモック |
| 実装 | 6 週間 | iOS エンジニア | アプリ実装、CI、ユニット/UI テスト |
| 検証 | 2 週間 | QA / CS | 受け入れテスト、TestFlight 配信 |
| リリース/運用 | 継続 | 全員 | KPI モニタリング、改善サイクル |

## 9. リスクと対策
- **Supabase 障害**: 重要操作はローカルキューに積み、リトライと最大リトライ回数を設定済み。
- **家族内共有要件の拡張**: 将来の世帯共有を見越して `userId` を全モデルに保持。
- **法規制/個人情報**: Login と API 通信は HTTPS + Supabase 認証、Secrets.plist でキー管理。
- **UI/UX 複雑化**: SwiftUI + アクセシビリティ識別子で自動テストを整備し、退行を防止。

## 10. まとめ
FamilyStock は家庭内での「在庫 → 買い物 → 記録」の循環を 1 つのモバイル体験に統合し、オフラインファーストな安心感と Supabase 連携による共有性を両立する。上記 KPI を指標に、段階的な機能拡張とデータドリブンな改善を進める。
